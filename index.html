<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta content="stuff, to, help, search, engines, not" name="keywords">
<meta content="What this page is about." name="description">
<meta content="Display Webcam Stream" name="title">
<meta name="apple-mobile-web-app-capable" content="yes">
<title>Starhub CNY 2019</title>


<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<link rel="stylesheet" href="styles.css">

</head>

<body>
    <div class="header">
        <img id="sensetimeLogo" src="sensetime_logo.jpg">
        <span id="eventTitle">
            <center>
                <h2>GUEST</h2>
                <h2>REGISTRATION</h2>
            </center>
        </span>
        <img id="starhubLogo" src="starhub_logo_white_bg.jpg">
    </div>
    <video autoplay="true" id="webCam"></video>
    
    <!--<div class="footer">
        <center>
            <h2>Welcome {{Guest Name}}</h2>
        </center>
    </div>-->

    <canvas id="captureButton" onclick="capturePhoto()"></canvas>
    <div id="regInstruction">Snap a photo of your face to register</div>

    <canvas id="capturedImg" width="900" height="350"></canvas>
    

    <script>
        var capImgCtx, imgCanvas, video;

        $(document).ready(function() {
            var canvas = document.getElementById("captureButton");

            var context = canvas.getContext('2d');
            var centerX = canvas.width / 2;
            var centerY = canvas.height / 2;
            var radius = 60;

            context.beginPath();
            context.arc(centerX, centerY, radius, 0, 2 * Math.PI, false);
            context.fillStyle = 'white';
            context.fill();
            context.lineWidth = 10;
            context.strokeStyle = "#73c20e";
            context.stroke();

            imgCanvas = document.getElementById("capturedImg");
            capImgCtx = imgCanvas.getContext('2d');

            video = $('#webCam')[0];
            //const video = $('#webCam')[0];
            function onStreaming(stream) {
                video.srcObject = stream;
            }

            

            navigator.mediaDevices.getUserMedia({ video: true }).then(onStreaming);
        });

        function capturePhoto(){
            console.log('btn clicked');
            alert('btn clicked');
            console.log(video);
            capImgCtx.drawImage(video, 0,0, imgCanvas.width, imgCanvas.height);
            console.log('imgCanvas');
            console.log(imgCanvas);
            console.log('capImgCtx');
            console.log(capImgCtx);
        }
    </script>
</body>
</html>
